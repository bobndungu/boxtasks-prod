# Current user endpoint.

boxtasks_api.current_user:
  path: '/api/me'
  defaults:
    _controller: '\Drupal\boxtasks_api\Controller\CurrentUserController::getCurrentUser'
  methods: [GET]
  requirements:
    _user_is_logged_in: 'TRUE'
  options:
    _auth: ['oauth2', 'cookie']
    no_cache: TRUE

# Workspace roles endpoint - bypasses JSON:API access issues.
boxtasks_api.workspace_roles:
  path: '/api/workspace/{workspace_id}/roles'
  defaults:
    _controller: '\Drupal\boxtasks_api\Controller\WorkspaceRolesController::getRoles'
  methods: [GET]
  requirements:
    _user_is_logged_in: 'TRUE'
  options:
    _auth: ['oauth2', 'cookie']
    no_cache: TRUE
    parameters:
      workspace_id:
        type: string

# Update a workspace role.
boxtasks_api.update_role:
  path: '/api/roles/{role_id}'
  defaults:
    _controller: '\Drupal\boxtasks_api\Controller\WorkspaceRolesController::updateRole'
  methods: [PATCH]
  requirements:
    _user_is_logged_in: 'TRUE'
  options:
    _auth: ['oauth2', 'cookie']
    no_cache: TRUE
    parameters:
      role_id:
        type: string

# Create a workspace role.
boxtasks_api.create_role:
  path: '/api/roles'
  defaults:
    _controller: '\Drupal\boxtasks_api\Controller\WorkspaceRolesController::createRole'
  methods: [POST]
  requirements:
    _user_is_logged_in: 'TRUE'
  options:
    _auth: ['oauth2', 'cookie']
    no_cache: TRUE

# Delete a workspace role.
boxtasks_api.delete_role:
  path: '/api/roles/{role_id}'
  defaults:
    _controller: '\Drupal\boxtasks_api\Controller\WorkspaceRolesController::deleteRole'
  methods: [DELETE]
  requirements:
    _user_is_logged_in: 'TRUE'
  options:
    _auth: ['oauth2', 'cookie']
    no_cache: TRUE
    parameters:
      role_id:
        type: string

# Field Groups endpoints.
boxtasks_api.field_groups:
  path: '/api/boards/{board_id}/field-groups'
  defaults:
    _controller: '\Drupal\boxtasks_api\Controller\FieldGroupsController::getGroups'
  methods: [GET]
  requirements:
    _user_is_logged_in: 'TRUE'
  options:
    _auth: ['oauth2', 'cookie']
    no_cache: TRUE
    parameters:
      board_id:
        type: string

boxtasks_api.create_field_group:
  path: '/api/field-groups'
  defaults:
    _controller: '\Drupal\boxtasks_api\Controller\FieldGroupsController::createGroup'
  methods: [POST]
  requirements:
    _user_is_logged_in: 'TRUE'
  options:
    _auth: ['oauth2', 'cookie']
    no_cache: TRUE

boxtasks_api.update_field_group:
  path: '/api/field-groups/{group_id}'
  defaults:
    _controller: '\Drupal\boxtasks_api\Controller\FieldGroupsController::updateGroup'
  methods: [PATCH]
  requirements:
    _user_is_logged_in: 'TRUE'
  options:
    _auth: ['oauth2', 'cookie']
    no_cache: TRUE
    parameters:
      group_id:
        type: string

boxtasks_api.delete_field_group:
  path: '/api/field-groups/{group_id}'
  defaults:
    _controller: '\Drupal\boxtasks_api\Controller\FieldGroupsController::deleteGroup'
  methods: [DELETE]
  requirements:
    _user_is_logged_in: 'TRUE'
  options:
    _auth: ['oauth2', 'cookie']
    no_cache: TRUE
    parameters:
      group_id:
        type: string

# File upload endpoint.
boxtasks_api.file_upload:
  path: '/api/files/upload'
  defaults:
    _controller: '\Drupal\boxtasks_api\Controller\FileUploadController::uploadFile'
  methods: [POST]
  requirements:
    _user_is_logged_in: 'TRUE'
  options:
    _auth: ['oauth2', 'cookie']
    no_cache: TRUE

# Create attachment with file upload.
boxtasks_api.create_attachment:
  path: '/api/cards/{card_id}/attachments'
  defaults:
    _controller: '\Drupal\boxtasks_api\Controller\FileUploadController::createAttachment'
  methods: [POST]
  requirements:
    _user_is_logged_in: 'TRUE'
  options:
    _auth: ['oauth2', 'cookie']
    no_cache: TRUE
    parameters:
      card_id:
        type: string
